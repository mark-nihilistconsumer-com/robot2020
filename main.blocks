<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="iM}5N2d^%P[Ly!n5_L}`">robot</variable></variables><block type="pxt-on-start" id="Fc9e@Wi9QC@xjTgdyFX(" x="124" y="8"><statement name="HANDLER"><block type="typescript_statement" id="Ft9n4(c]Z`8-+Bu1GCLH" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace CardboardRobotBlocks {" line1="" line2="    let _onShotCallbacks: ((shooter: number) =&gt; void)[] = []" line3="    let _onMeetNewRobotCallbacks: ((robot: number) =&gt; void)[] = []" line4="    let _knownRobots: number[] = []" line5="" line6="" line7="    //% block=&quot;On I Got Shot&quot;" line8="    export function addOnShotHandler(onshot: (shooter: number) =&gt; void): void {" line9="        _onShotCallbacks.push(onshot)" line10="    };" line11="" line12="    //% block=&quot;On Meet New Robot&quot;" line13="    export function addOnMeetNewRobotHandler(onMeetNewRobot: (robot: number) =&gt; void): void {" line14="        _onMeetNewRobotCallbacks.push(onMeetNewRobot)" line15="    };" line16="" line17="    //% block=&quot;Shoot Robot $robot&quot;" line18="    export function shoot(robot: number): void {" line19="        radio.sendValue(&quot;BANG&quot;, robot)" line20="    }" line21="" line22="    //% block=&quot;Introduce Self&quot;" line23="    export function introduceSelf(): void {" line24="        radio.sendString(&quot;HELLO&quot;)" line25="    }" line26="" line27="    //% block=&quot;Known Robots&quot;" line28="    export function knownRobots(): number[] {" line29="        return _knownRobots.slice()" line30="    }" line31="" line32="    //% block=&quot;Join Game&quot;" line33="    export function joinGame(): void {" line34="" line35="        radio.onReceivedValue(function (name: string, value: number) {" line36="            let sender = radio.receivedPacket(RadioPacketProperty.SerialNumber)" line37="            if (name == &quot;BANG&quot;) {" line38="                if (value == control.deviceSerialNumber()) {" line39="                    getShot(sender)" line40="                }" line41="            }" line42="        })" line43="" line44="        radio.onReceivedString(function (receivedString: string) {" line45="            let sender2 = radio.receivedPacket(RadioPacketProperty.SerialNumber)" line46="            if (receivedString == &quot;HELLO&quot;) {" line47="                meetNewRobot(sender2)" line48="            }" line49="        })" line50="        radio.setTransmitSerialNumber(true)" line51="    }" line52="    " line53="    function getShot(shooter: number): void {" line54="        for (let onShotHandler of _onShotCallbacks) {" line55="            onShotHandler(shooter)" line56="        }" line57="    }" line58="" line59="    function meetNewRobot(robot: number): void {" line60="        if (_knownRobots.indexOf(robot) != -1) {" line61="            _knownRobots.push(robot)" line62="            for (let onMeetNewRobotHandler of _onMeetNewRobotCallbacks) {" line63="                onMeetNewRobotHandler(robot)" line64="            }" line65="        }" line66="    }" line67="}" numlines="68"></mutation></block></statement></block></xml>